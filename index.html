<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="main.css" />
        
        <script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>
        
        <script type="text/javascript">
            var currentMode = "mysql";
            
            function changeMode(mode) {
                currentMode = mode;
                
                console.log("Selected mode is " + currentMode);
                updateBook();
            }
        </script>
        
        <script type="text/javascript">
            function readBook() {
                var dbReadScript;
                if (currentMode == "azure") {
                    dbReadScript = "read-azure.php";
                } else {
                    dbReadScript = "read-mysql.php";
                }
                
                $("#addressBook").html("");
                    $.ajax({
                        type: 'POST',
                        url: dbReadScript,
                        success: makeTable,
                        error: function() {
                            alert("Error reading database!");
                        }
                    });
            }
            
            function updateBook() {
                $("#addressBook").html("");
                readBook();
            }
            
            function makeTable(dataIn) {
                var rowCount = "odd";
                
                var headRow = "<tr>" +
                    "<th>First Name</th>" +
                    "<th>Last Name</th>" +
                    "<th>Email</th>" +
                    "<th>Phone</th>" +
                    "<th>GitHub</th>" +
                    "<th>City</th>" +
                    "<th>Region</th>" +
                    "<th>Country</th>" +
                    "<th>Occupation</th>" +
                    "<th>Modify</th>" +
                "</tr>";
                
                $("#addressBook").html(headRow);
                
                $.each($.parseJSON(dataIn), function() {
                   var thisRow = "<tr id=\"row" + this.id + "\" class=\"" + rowCount + "\">" +
                       "<td>" + this.firstName + "</td>" +
                       "<td>" + this.lastName + "</td>" +
                       "<td>" + this.email + "</td>" +
                       "<td>" + this.phone + "</td>" +
                       "<td>" + this.github + "</td>" +
                       "<td>" + this.city + "</td>" +
                       "<td>" + this.region + "</td>" +
                       "<td>" + this.country + "</td>" +
                       "<td>" + this.occupation + "</td>" +
                       "<td> </td>" +
                       "</tr>";
                   
                   if(rowCount == "odd") {
                       rowCount = "even";
                   } else {
                       rowCount = "odd";
                   }
                    
                    $(thisRow).appendTo("#addressBook");
                });
            }
            
            $(document).ready(function() {
                $("input[type=radio][name=database-mode]").on("change", function() {
                    if(this.value == "mysql") {
                        changeMode("mysql");
                    } else {
                        changeMode("azure");
                    }
                });
                
                readBook();
            });
        </script>
    </head>
    
    <body>
        <!-- Mode Selector -->
        <div id="mode-select">
            Mode:
            <input type="radio" name="database-mode" value="mysql" checked> MySQL
            <input type="radio" name="database-mode" value="azure"> Azure
        </div>
        <br />
        <table id="addressBook">
            
            
        </table>
    </body>
</html>